{"ast":null,"code":"import _objectSpread from\"G:/studentPortal Fyp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"G:/studentPortal Fyp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"G:\\\\studentPortal Fyp\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{LOGIN,LOGIN_LOADER,LOGOUT,REGISTER_LOADER,RESET_PASSWORD}from\"../types\";import firebase from\"../../config/firebase\";export var signupLoader=function signupLoader(val){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch({type:REGISTER_LOADER,payload:val});case 1:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var LogInLoader=function LogInLoader(val){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch({type:LOGIN_LOADER,payload:val});case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var login=function login(loginData){var onSuccess=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};var onError=arguments.length>2&&arguments[2]!==undefined?arguments[2]:function(){};return function(dispatch){dispatch({type:LOGIN_LOADER,payload:true});firebase.auth().signInWithEmailAndPassword(loginData.email,loginData.password).then(function(data){firebase.firestore().collection(\"users\").doc(data.user.uid).onSnapshot(function(doc){var user=doc.data();if(user.blocked){firebase.auth().signOut();alert(\"Your account has been blocked. Please contact the admin.\");}else{dispatch({type:LOGIN,payload:_objectSpread({id:doc.id},user)});onSuccess();}});dispatch({type:LOGIN_LOADER,payload:false});}).catch(function(error){alert(error.message);dispatch({type:LOGIN_LOADER,payload:false});onError();});};};export var signUp=function signUp(payload,password,history){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(payload,password);dispatch(signupLoader(true));firebase.auth().createUserWithEmailAndPassword(payload.email,password).then(function(data){console.log(data,'talha');firebase.firestore().collection(\"users\").doc(data.user.uid).set(_objectSpread(_objectSpread({},payload),{},{createdAt:firebase.firestore.Timestamp.now()})).then(function(res){dispatch(signupLoader(false));alert(\"Account Created Successfully\");history.push(\"/auth/admin\");}).catch(function(err){dispatch(signupLoader(false));alert(err.message,\"danger\");});});case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var forgetPassword=function forgetPassword(email){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:dispatch({type:RESET_PASSWORD,payload:true});_context4.prev=1;_context4.next=4;return firebase.auth().sendPasswordResetEmail(email).then(function(){dispatch({type:RESET_PASSWORD,payload:false});alert(\"Check your email and reset your password\");});case 4:_context4.next=10;break;case 6:_context4.prev=6;_context4.t0=_context4[\"catch\"](1);alert(_context4.t0.message);dispatch({type:RESET_PASSWORD,payload:false});case 10:case\"end\":return _context4.stop();}}},_callee4,null,[[1,6]]);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export var logout=function logout(){var onSuccess=arguments.length>0&&arguments[0]!==undefined?arguments[0]:function(){};return function(dispatch){firebase.auth().signOut().then(function(data){dispatch({type:LOGOUT,uid:\"\",user:\"\",error:\"\"});onSuccess();}).catch(function(error){dispatch({type:\"LOGOUT_FAIL\",uid:\"\",error:error});});};};","map":{"version":3,"sources":["G:/studentPortal Fyp/src/store/actions/authAction.js"],"names":["LOGIN","LOGIN_LOADER","LOGOUT","REGISTER_LOADER","RESET_PASSWORD","firebase","signupLoader","val","dispatch","type","payload","LogInLoader","login","loginData","onSuccess","onError","auth","signInWithEmailAndPassword","email","password","then","data","firestore","collection","doc","user","uid","onSnapshot","blocked","signOut","alert","id","catch","error","message","signUp","history","console","log","createUserWithEmailAndPassword","set","createdAt","Timestamp","now","res","push","err","forgetPassword","sendPasswordResetEmail","logout"],"mappings":"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","sourcesContent":["import {\r\n  LOGIN,\r\n  LOGIN_LOADER,\r\n  LOGOUT,\r\n  REGISTER_LOADER,\r\n  RESET_PASSWORD,\r\n} from \"../types\";\r\nimport firebase from \"../../config/firebase\";\r\nexport const signupLoader = (val) => async (dispatch) => {\r\n  dispatch({\r\n    type: REGISTER_LOADER,\r\n    payload: val,\r\n  });\r\n};\r\nexport const LogInLoader = (val) => async (dispatch) => {\r\n  dispatch({\r\n    type: LOGIN_LOADER,\r\n    payload: val,\r\n  });\r\n};\r\n\r\nexport const login = (loginData, onSuccess = () => {}, onError = () => {}) => {\r\n  return (dispatch) => {\r\n    dispatch({\r\n      type: LOGIN_LOADER,\r\n      payload: true,\r\n    });\r\n    firebase\r\n      .auth()\r\n      .signInWithEmailAndPassword(loginData.email, loginData.password)\r\n      .then((data) => {\r\n        firebase\r\n          .firestore()\r\n          .collection(\"users\")\r\n          .doc(data.user.uid)\r\n          .onSnapshot((doc) => {\r\n            const user = doc.data();\r\n            if (user.blocked) {\r\n              firebase.auth().signOut();\r\n              alert(\"Your account has been blocked. Please contact the admin.\");\r\n            } else {\r\n              dispatch({\r\n                type: LOGIN,\r\n                payload: { id: doc.id, ...user },\r\n              });\r\n\r\n              onSuccess();\r\n            }\r\n          });\r\n        dispatch({\r\n          type: LOGIN_LOADER,\r\n          payload: false,\r\n        });\r\n      })\r\n      .catch((error) => {\r\n        alert(error.message);\r\n        dispatch({\r\n          type: LOGIN_LOADER,\r\n          payload: false,\r\n        });\r\n        onError();\r\n      });\r\n  };\r\n};\r\n\r\nexport const signUp = (payload, password, history) => async (dispatch) => {\r\n  console.log(payload, password);\r\n  dispatch(signupLoader(true));\r\n  firebase\r\n    .auth()\r\n    .createUserWithEmailAndPassword(payload.email, password)\r\n    .then((data) => {\r\n      console.log(data,'talha')\r\n      firebase\r\n        .firestore()\r\n        .collection(\"users\")\r\n        .doc(data.user.uid)\r\n        .set({\r\n          ...payload,\r\n          createdAt: firebase.firestore.Timestamp.now(),\r\n        })\r\n        .then((res) => {\r\n          dispatch(signupLoader(false));\r\n          alert(\"Account Created Successfully\");\r\n          history.push(\"/auth/admin\");\r\n        })\r\n        .catch((err) => {\r\n          dispatch(signupLoader(false));\r\n          alert(err.message, \"danger\");\r\n        });\r\n    });\r\n};\r\n\r\nexport const forgetPassword = (email) => async (dispatch) => {\r\n  dispatch({\r\n    type: RESET_PASSWORD,\r\n    payload: true,\r\n  });\r\n  try {\r\n    await firebase\r\n      .auth()\r\n      .sendPasswordResetEmail(email)\r\n      .then(() => {\r\n        dispatch({\r\n          type: RESET_PASSWORD,\r\n          payload: false,\r\n        });\r\n        alert(\"Check your email and reset your password\");\r\n      });\r\n  } catch (error) {\r\n    alert(error.message);\r\n    dispatch({\r\n      type: RESET_PASSWORD,\r\n      payload: false,\r\n    });\r\n  }\r\n};\r\n\r\nexport const logout = (onSuccess = () => {}) => {\r\n  return (dispatch) => {\r\n    firebase\r\n      .auth()\r\n      .signOut()\r\n      .then((data) => {\r\n        dispatch({\r\n          type: LOGOUT,\r\n          uid: \"\",\r\n          user: \"\",\r\n          error: \"\",\r\n        });\r\n        onSuccess();\r\n      })\r\n      .catch((error) => {\r\n        dispatch({\r\n          type: \"LOGOUT_FAIL\",\r\n          uid: \"\",\r\n          error: error,\r\n        });\r\n      });\r\n  };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}