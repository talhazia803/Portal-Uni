{"ast":null,"code":"import _objectSpread from \"G:/studentPortal Fyp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { LOGIN, LOGIN_LOADER, LOGOUT, REGISTER_LOADER, RESET_PASSWORD } from \"../types\";\nimport firebase from \"../../config/firebase\";\nexport var signupLoader = function signupLoader(val) {\n  return {\n    type: REGISTER_LOADER,\n    payload: val\n  };\n};\nexport var loginLoader = function loginLoader(val) {\n  return {\n    type: LOGIN_LOADER,\n    payload: val\n  };\n};\nexport var login = function login(loginData) {\n  var onSuccess = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};\n  var onError = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {};\n  return function (dispatch) {\n    dispatch(loginLoader(true));\n    firebase.auth().signInWithEmailAndPassword(loginData.email, loginData.password).then(function (data) {\n      firebase.firestore().collection(\"users\").doc(data.user.uid).get().then(function (doc) {\n        var user = doc.data();\n\n        if (user.blocked) {\n          firebase.auth().signOut();\n          alert(\"Your account has been blocked. Please contact the admin.\");\n        } else {\n          dispatch({\n            type: LOGIN,\n            payload: _objectSpread({\n              uid: doc.id\n            }, user)\n          });\n          onSuccess();\n        }\n      }).catch(function (error) {\n        alert(error.message);\n      });\n    }).catch(function (error) {\n      alert(error.message);\n      onError();\n    }).finally(function () {\n      dispatch(loginLoader(false));\n    });\n  };\n};\nexport var signUp = function signUp(payload, password) {\n  return function (dispatch) {\n    dispatch(signupLoader(true));\n    firebase.auth().createUserWithEmailAndPassword(payload.email, password).then(function (data) {\n      firebase.firestore().collection(\"users\").doc(data.user.uid).set(_objectSpread(_objectSpread({}, payload), {}, {\n        createdAt: firebase.firestore.Timestamp.now()\n      })).then(function () {\n        alert(\"Account Created Successfully\");\n      }).catch(function (err) {\n        alert(err.message);\n      });\n    }).finally(function () {\n      dispatch(signupLoader(false));\n    });\n  };\n};\nexport var forgetPassword = function forgetPassword(email) {\n  return function (dispatch) {\n    dispatch({\n      type: RESET_PASSWORD,\n      payload: true\n    });\n    firebase.auth().sendPasswordResetEmail(email).then(function () {\n      alert(\"Check your email and reset your password\");\n    }).catch(function (error) {\n      alert(error.message);\n    }).finally(function () {\n      dispatch({\n        type: RESET_PASSWORD,\n        payload: false\n      });\n    });\n  };\n};\nexport var logout = function logout() {\n  var onSuccess = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function () {};\n  return function (dispatch) {\n    firebase.auth().signOut().then(function () {\n      dispatch({\n        type: LOGOUT\n      });\n      onSuccess();\n    }).catch(function (error) {// dispatch({\n      //   type: LOGOUT_FAIL,\n      //   error: error,\n      // });\n    });\n  };\n};","map":{"version":3,"sources":["G:/studentPortal Fyp/src/store/actions/authAction.js"],"names":["LOGIN","LOGIN_LOADER","LOGOUT","REGISTER_LOADER","RESET_PASSWORD","firebase","signupLoader","val","type","payload","loginLoader","login","loginData","onSuccess","onError","dispatch","auth","signInWithEmailAndPassword","email","password","then","data","firestore","collection","doc","user","uid","get","blocked","signOut","alert","id","catch","error","message","finally","signUp","createUserWithEmailAndPassword","set","createdAt","Timestamp","now","err","forgetPassword","sendPasswordResetEmail","logout"],"mappings":"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","sourcesContent":["import {\r\n  LOGIN,\r\n  LOGIN_LOADER,\r\n  LOGOUT,\r\n  REGISTER_LOADER,\r\n  RESET_PASSWORD,\r\n} from \"../types\";\r\nimport firebase from \"../../config/firebase\";\r\n\r\nexport const signupLoader = (val) => ({\r\n  type: REGISTER_LOADER,\r\n  payload: val,\r\n});\r\n\r\nexport const loginLoader = (val) => ({\r\n  type: LOGIN_LOADER,\r\n  payload: val,\r\n});\r\n\r\nexport const login = (\r\n  loginData,\r\n  onSuccess = () => {},\r\n  onError = () => {}\r\n) => {\r\n  return (dispatch) => {\r\n    dispatch(loginLoader(true));\r\n    firebase\r\n      .auth()\r\n      .signInWithEmailAndPassword(loginData.email, loginData.password)\r\n      .then((data) => {\r\n        firebase\r\n          .firestore()\r\n          .collection(\"users\")\r\n          .doc(data.user.uid)\r\n          .get()\r\n          .then((doc) => {\r\n            const user = doc.data();\r\n            if (user.blocked) {\r\n              firebase.auth().signOut();\r\n              alert(\"Your account has been blocked. Please contact the admin.\");\r\n            } else {\r\n              dispatch({\r\n                type: LOGIN,\r\n                payload: { uid: doc.id, ...user },\r\n              });\r\n              onSuccess();\r\n            }\r\n          })\r\n          .catch((error) => {\r\n            alert(error.message);\r\n          });\r\n      })\r\n      .catch((error) => {\r\n        alert(error.message);\r\n        onError();\r\n      })\r\n      .finally(() => {\r\n        dispatch(loginLoader(false));\r\n      });\r\n  };\r\n};\r\n\r\nexport const signUp = (payload, password) => {\r\n  return (dispatch) => {\r\n    dispatch(signupLoader(true));\r\n    firebase\r\n      .auth()\r\n      .createUserWithEmailAndPassword(payload.email, password)\r\n      .then((data) => {\r\n        firebase\r\n          .firestore()\r\n          .collection(\"users\")\r\n          .doc(data.user.uid)\r\n          .set({\r\n            ...payload,\r\n            createdAt: firebase.firestore.Timestamp.now(),\r\n          })\r\n          .then(() => {\r\n            alert(\"Account Created Successfully\");\r\n          })\r\n          .catch((err) => {\r\n            alert(err.message);\r\n          });\r\n      })\r\n      .finally(() => {\r\n        dispatch(signupLoader(false));\r\n      });\r\n  };\r\n};\r\n\r\nexport const forgetPassword = (email) => {\r\n  return (dispatch) => {\r\n    dispatch({\r\n      type: RESET_PASSWORD,\r\n      payload: true,\r\n    });\r\n    firebase\r\n      .auth()\r\n      .sendPasswordResetEmail(email)\r\n      .then(() => {\r\n        alert(\"Check your email and reset your password\");\r\n      })\r\n      .catch((error) => {\r\n        alert(error.message);\r\n      })\r\n      .finally(() => {\r\n        dispatch({\r\n          type: RESET_PASSWORD,\r\n          payload: false,\r\n        });\r\n      });\r\n  };\r\n};\r\n\r\nexport const logout = (onSuccess = () => {}) => {\r\n  return (dispatch) => {\r\n    firebase\r\n      .auth()\r\n      .signOut()\r\n      .then(() => {\r\n        dispatch({\r\n          type: LOGOUT,\r\n        });\r\n        onSuccess();\r\n      })\r\n      .catch((error) => {\r\n        // dispatch({\r\n        //   type: LOGOUT_FAIL,\r\n        //   error: error,\r\n        // });\r\n      });\r\n  };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}