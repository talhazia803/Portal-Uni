{"ast":null,"code":"import _objectSpread from \"G:/studentPortal Fyp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _asyncToGenerator from \"G:/studentPortal Fyp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _regeneratorRuntime from \"G:\\\\studentPortal Fyp\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";\nimport { LOGIN, LOGIN_LOADER, LOGOUT, REGISTER_LOADER, RESET_PASSWORD } from \"../types\";\nimport firebase from \"../../config/firebase\";\nexport var signupLoader = function signupLoader(val) {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              dispatch({\n                type: REGISTER_LOADER,\n                payload: val\n              });\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};\nexport var LogInLoader = function LogInLoader(val) {\n  return /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch) {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              dispatch({\n                type: LOGIN_LOADER,\n                payload: val\n              });\n\n            case 1:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function (_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n};\nexport var login = function login(loginData) {\n  var onSuccess = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {};\n  var onError = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {};\n  return function (dispatch) {\n    dispatch({\n      type: LOGIN_LOADER,\n      payload: true\n    });\n    firebase.auth().signInWithEmailAndPassword(loginData.email, loginData.password).then(function (data) {\n      firebase.firestore().collection(\"users\").doc(data.user.uid).onSnapshot(function (doc) {\n        var user = doc.data();\n\n        if (user.blocked) {\n          firebase.auth().signOut();\n          alert(\"Your account has been blocked. Please contact the admin.\");\n        } else {\n          dispatch({\n            type: LOGIN,\n            payload: _objectSpread({\n              id: doc.id\n            }, user)\n          });\n          onSuccess();\n        }\n      });\n      dispatch({\n        type: LOGIN_LOADER,\n        payload: false\n      });\n    }).catch(function (error) {\n      alert(error.message);\n      dispatch({\n        type: LOGIN_LOADER,\n        payload: false\n      });\n      onError();\n    });\n  };\n};\nexport var signUp = function signUp(payload, password, history) {\n  return /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              console.log(payload, password);\n              dispatch(signupLoader(true));\n              firebase.auth().createUserWithEmailAndPassword(payload.email, password).then(function (data) {\n                firebase.firestore().collection(\"users\").doc(data.user.uid).set(_objectSpread(_objectSpread({}, payload), {}, {\n                  createdAt: firebase.firestore.Timestamp.now()\n                })).then(function (res) {\n                  dispatch(signupLoader(false));\n                  alert(\"Account Created Successfully\");\n                  history.push(\"/auth/admin\");\n                }).catch(function (err) {\n                  dispatch(signupLoader(false));\n                  alert(err.message, \"danger\");\n                });\n              });\n\n            case 3:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function (_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n};\nexport var forgetPassword = function forgetPassword(email) {\n  return /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch) {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              dispatch({\n                type: RESET_PASSWORD,\n                payload: true\n              });\n              _context4.prev = 1;\n              _context4.next = 4;\n              return firebase.auth().sendPasswordResetEmail(email).then(function () {\n                dispatch({\n                  type: RESET_PASSWORD,\n                  payload: false\n                });\n                alert(\"Check your email and reset your password\");\n              });\n\n            case 4:\n              _context4.next = 10;\n              break;\n\n            case 6:\n              _context4.prev = 6;\n              _context4.t0 = _context4[\"catch\"](1);\n              alert(_context4.t0.message);\n              dispatch({\n                type: RESET_PASSWORD,\n                payload: false\n              });\n\n            case 10:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[1, 6]]);\n    }));\n\n    return function (_x4) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n};\nexport var logout = function logout() {\n  var onSuccess = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function () {};\n  return function (dispatch) {\n    firebase.auth().signOut().then(function (data) {\n      dispatch({\n        type: LOGOUT,\n        uid: \"\",\n        user: \"\",\n        error: \"\"\n      });\n      onSuccess();\n    }).catch(function (error) {\n      dispatch({\n        type: \"LOGOUT_FAIL\",\n        uid: \"\",\n        error: error\n      });\n    });\n  };\n};","map":{"version":3,"sources":["G:/studentPortal Fyp/src/store/actions/authAction.js"],"names":["LOGIN","LOGIN_LOADER","LOGOUT","REGISTER_LOADER","RESET_PASSWORD","firebase","signupLoader","val","dispatch","type","payload","LogInLoader","login","loginData","onSuccess","onError","auth","signInWithEmailAndPassword","email","password","then","data","firestore","collection","doc","user","uid","onSnapshot","blocked","signOut","alert","id","catch","error","message","signUp","history","console","log","createUserWithEmailAndPassword","set","createdAt","Timestamp","now","res","push","err","forgetPassword","sendPasswordResetEmail","logout"],"mappings":"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","sourcesContent":["import {\r\n  LOGIN,\r\n  LOGIN_LOADER,\r\n  LOGOUT,\r\n  REGISTER_LOADER,\r\n  RESET_PASSWORD,\r\n} from \"../types\";\r\nimport firebase from \"../../config/firebase\";\r\nexport const signupLoader = (val) => async (dispatch) => {\r\n  dispatch({\r\n    type: REGISTER_LOADER,\r\n    payload: val,\r\n  });\r\n};\r\nexport const LogInLoader = (val) => async (dispatch) => {\r\n  dispatch({\r\n    type: LOGIN_LOADER,\r\n    payload: val,\r\n  });\r\n};\r\n\r\nexport const login = (loginData, onSuccess = () => {}, onError = () => {}) => {\r\n  return (dispatch) => {\r\n    dispatch({\r\n      type: LOGIN_LOADER,\r\n      payload: true,\r\n    });\r\n    firebase\r\n      .auth()\r\n      .signInWithEmailAndPassword(loginData.email, loginData.password)\r\n      .then((data) => {\r\n        firebase\r\n          .firestore()\r\n          .collection(\"users\")\r\n          .doc(data.user.uid)\r\n          .onSnapshot((doc) => {\r\n            const user = doc.data();\r\n            if (user.blocked) {\r\n              firebase.auth().signOut();\r\n              alert(\"Your account has been blocked. Please contact the admin.\");\r\n            } else {\r\n              dispatch({\r\n                type: LOGIN,\r\n                payload: { id: doc.id, ...user },\r\n              });\r\n\r\n              onSuccess();\r\n            }\r\n          });\r\n        dispatch({\r\n          type: LOGIN_LOADER,\r\n          payload: false,\r\n        });\r\n      })\r\n      .catch((error) => {\r\n        alert(error.message);\r\n        dispatch({\r\n          type: LOGIN_LOADER,\r\n          payload: false,\r\n        });\r\n        onError();\r\n      });\r\n  };\r\n};\r\n\r\nexport const signUp = (payload, password, history) => async (dispatch) => {\r\n  console.log(payload, password);\r\n  dispatch(signupLoader(true));\r\n  firebase\r\n    .auth()\r\n    .createUserWithEmailAndPassword(payload.email, password)\r\n    .then((data) => {\r\n      firebase\r\n        .firestore()\r\n        .collection(\"users\")\r\n        .doc(data.user.uid)\r\n        .set({\r\n          ...payload,\r\n          createdAt: firebase.firestore.Timestamp.now(),\r\n        })\r\n        .then((res) => {\r\n          dispatch(signupLoader(false));\r\n          alert(\"Account Created Successfully\");\r\n          history.push(\"/auth/admin\");\r\n        })\r\n        .catch((err) => {\r\n          dispatch(signupLoader(false));\r\n          alert(err.message, \"danger\");\r\n        });\r\n    });\r\n};\r\n\r\nexport const forgetPassword = (email) => async (dispatch) => {\r\n  dispatch({\r\n    type: RESET_PASSWORD,\r\n    payload: true,\r\n  });\r\n  try {\r\n    await firebase\r\n      .auth()\r\n      .sendPasswordResetEmail(email)\r\n      .then(() => {\r\n        dispatch({\r\n          type: RESET_PASSWORD,\r\n          payload: false,\r\n        });\r\n        alert(\"Check your email and reset your password\");\r\n      });\r\n  } catch (error) {\r\n    alert(error.message);\r\n    dispatch({\r\n      type: RESET_PASSWORD,\r\n      payload: false,\r\n    });\r\n  }\r\n};\r\n\r\nexport const logout = (onSuccess = () => {}) => {\r\n  return (dispatch) => {\r\n    firebase\r\n      .auth()\r\n      .signOut()\r\n      .then((data) => {\r\n        dispatch({\r\n          type: LOGOUT,\r\n          uid: \"\",\r\n          user: \"\",\r\n          error: \"\",\r\n        });\r\n        onSuccess();\r\n      })\r\n      .catch((error) => {\r\n        dispatch({\r\n          type: \"LOGOUT_FAIL\",\r\n          uid: \"\",\r\n          error: error,\r\n        });\r\n      });\r\n  };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}